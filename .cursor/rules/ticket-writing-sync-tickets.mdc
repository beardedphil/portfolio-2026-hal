---
description: Supabase-backed Kanban — ALWAYS update tickets in the DB first, then run sync (all agents)
alwaysApply: true
---

# Ticket Source of Truth: Supabase Only (All Agents)

We use a **Supabase-backed Kanban** in **Supabase-only mode** (0065). Ticket state (content, column, position) lives in the database. The app and agents **do not read from `docs/tickets/*.md`** — tickets are fetched directly from Supabase.

- **Do not create or edit ticket files** under `docs/tickets/` directly. The app does not read these files (Supabase-only mode).
- **To create or change a ticket (any agent):** use **HAL API endpoints**:
  - **Create / update body:** Use the HAL PM agent (create_ticket / update_ticket_body tools) or HAL API endpoint `POST /api/tickets/update`. The Kanban UI reflects changes within the polling interval (~10s).
  - **Move ticket column (e.g. QA → Human in the Loop):** Use HAL API endpoint `POST /api/tickets/move` with `{ ticketId: string, columnId: string }`. The API uses server-side Supabase credentials.
- **HAL API endpoints:** All Supabase operations go through HAL's API endpoints, which use server-side environment variables (`SUPABASE_URL`, `SUPABASE_ANON_KEY`). Agents don't need credentials in their environment.
  - `POST /api/tickets/get` — Fetch ticket content
  - `POST /api/tickets/update` — Update ticket body
  - `POST /api/tickets/move` — Move ticket to different column
  - `POST /api/artifacts/insert-implementation` — Store implementation artifacts
  - `POST /api/artifacts/insert-qa` — Store QA artifacts
- **`sync-tickets.js` is migration-only (0065):** The script no longer writes to `docs/tickets/*.md`. It can be used for one-time migration of existing files to Supabase (Docs→DB only).
- **Never commit `.env`** (it must remain ignored).
