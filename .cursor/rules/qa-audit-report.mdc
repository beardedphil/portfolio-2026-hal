---
description: QA agents must add a qa-report to the ticket audit folder
alwaysApply: true
---

# QA Audit Report (QA Agents)

When you **QA a ticket** (e.g. user asks to "QA", "verify", or "check" a ticket that is allegedly complete), you **must** add a QA report to that ticket’s audit folder.

## Required artifact

- **Path:** `docs/audit/<task-id>-<short-title>/qa-report.md`
- **When:** After performing QA (code review and, if possible, UI verification) for a ticket.

## qa-report.md structure

1. **Ticket & deliverable** — One-line goal, deliverable, and acceptance criteria from the ticket.
2. **Audit artifacts** — Confirm all required audit files are present (plan, worklog, changed-files, decisions, verification, pm-review).
3. **Code review** — PASS/FAIL with brief evidence (e.g. table of requirement vs implementation; file and line refs if helpful).
4. **UI verification** — What was run: automated and/or manual steps from `verification.md`. If automated UI was not run (e.g. native dialogs, login, or pickers), state that and list the manual steps the user should run.
5. **Verdict** — Implementation complete? OK to merge? Any blocking manual verification?

## Example location

For ticket `docs/tickets/0026-kanban-tickets-persist-column-on-refresh.md`, the QA report is:

`docs/audit/0026-kanban-tickets-persist-column-on-refresh/qa-report.md`

## QA on main (cloud QA branch access limitation)

- **For tickets marked "Merged to main for QA":** The implementation agent has already merged the feature branch to `main` due to cloud QA branch access limits. QA reviews and tests on `main` (not a feature branch).
- **Workflow:**
  - QA performs code review and automated verification on `main`.
  - QA still produces `docs/audit/<task-id>-<short-title>/qa-report.md` as required.
  - If verdict is **PASS:** QA commits the qa-report to `main`, moves ticket to Human in the Loop, and deletes the feature branch (if it still exists).
  - If verdict is **FAIL:** QA commits the qa-report to `main` and recommends a bugfix ticket.

## QA completion: do not hand off to the user

When the verdict is **PASS (OK to merge)**, QA must **complete the full workflow** — do not stop at a summary or "next steps for the user."

1. **Commit and push** the qa-report (and any rule changes):
   - **If ticket is "Merged to main for QA":** commit to `main`.
   - **Otherwise:** commit to the feature branch.
2. **Move ticket to Human in the Loop** — update the ticket **in the DB**, then run sync. Use `node scripts/move-ticket-column.js <ticketId> col-human-in-the-loop` from the repo root (e.g. `node scripts/move-ticket-column.js 0047 col-human-in-the-loop`). Requires `.env` with `SUPABASE_URL` and `SUPABASE_ANON_KEY`. The script updates Supabase, then the ticket file frontmatter, then runs `sync-tickets`. **Do not** add or edit YAML frontmatter in the ticket file by hand — Kanban is Supabase-backed; always update DB first, then sync.
3. **Merge to main** (only if not already merged):
   - **If ticket is "Merged to main for QA":** skip this step (already merged).
   - **Otherwise:** checkout `main`, merge the feature branch, push `main`.
4. **Delete the feature branch** — local and remote (see `delete-branch-after-merge.mdc`). If the ticket was "Merged to main for QA", the feature branch may still exist and should be deleted.
5. **Then** give your summary to the user.

Do not give a summary with "next steps" or "run these commands" — QA performs the merge and branch deletion. The user receives the completed result.

- Use a commit subject that includes the ticket ID (e.g. `qa(0033): add QA report, move to Human in the Loop`).
- **If verdict is FAIL:** Do not merge. Commit and push the qa-report only; summarize findings and recommend a bugfix ticket (see `bugfix-tracking.mdc`).

## Scope

- Applies to any QA or verification of a **ticketed** task (ticket under `docs/tickets/` with a matching folder under `docs/audit/`).
- Keep the report concise; use bullets and tables where appropriate.
